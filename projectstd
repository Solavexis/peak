local SCRIPT_URL = "https://raw.githubusercontent.com/Solavexis/peak/refs/heads/main/projectstd"

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

player.CharacterAdded:Connect(function(newChar)
    character = newChar
    hrp = newChar:WaitForChild("HumanoidRootPart")
end)

local function teleportTo(targetPlaceId)
    local tpGui = playerGui:FindFirstChild("Teleporting")
    if tpGui and tpGui:IsA("ScreenGui") then
        tpGui.Enabled = true
    end
    TeleportService:Teleport(targetPlaceId)
end

local function collectAllRings()
    if not hrp then return end
    local collectibles = Workspace:FindFirstChild("Collectibles")
    if not collectibles then return end
    for _, model in ipairs(collectibles:GetChildren()) do
        if model:IsA("Model") then
            local ring = model:FindFirstChild("Ring")
            if ring then
                local touch = ring:FindFirstChild("TouchInterest")
                if touch then
                    pcall(function()
                        firetouchinterest(ring, hrp, 0)
                        task.wait(0.01)
                        firetouchinterest(ring, hrp, 1)
                    end)
                end
            end
        end
    end
end

local function collectAllOrbs()
    if not hrp then return end
    local collectibles = Workspace:FindFirstChild("Collectibles")
    if not collectibles then return end
    for _, item in ipairs(collectibles:GetChildren()) do
        local orb = item:FindFirstChild("SpeedOrb")
        if orb then
            local touch = orb:FindFirstChild("TouchInterest")
            if touch then
                pcall(function()
                    firetouchinterest(orb, hrp, 0)
                    task.wait(0.01)
                    firetouchinterest(orb, hrp, 1)
                end)
            end
        end
    end
end

pcall(function()
    if queue_on_teleport then
        queue_on_teleport('loadstring(game:HttpGet("' .. SCRIPT_URL .. '"))()')
    elseif syn and syn.queue_on_teleport then
        syn.queue_on_teleport('loadstring(game:HttpGet("' .. SCRIPT_URL .. '"))()')
    end
end)

if game.PlaceId == 95932206229482 then
    return
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CustomFarmGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 210, 0, 320)
mainFrame.Position = UDim2.new(1, -230, 0.5, -160)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.BackgroundTransparency = 1
title.Text = "Custom Menu | Place: " .. game.PlaceId
title.TextColor3 = Color3.new(1, 1, 1)
title.TextScaled = true
title.Font = Enum.Font.GothamBold
title.Parent = mainFrame

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0, 8)
listLayout.SortOrder = Enum.SortOrder.LayoutOrder
listLayout.Parent = mainFrame

local dragging, dragStart, startPos
mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

local function createButton(text, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -20, 0, 45)
    btn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    btn.Text = text
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.TextScaled = true
    btn.Font = Enum.Font.GothamSemibold
    btn.Parent = mainFrame
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 8)
    btnCorner.Parent = btn
    btn.MouseButton1Click:Connect(callback)
    return btn
end

createButton("Music Player", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Solavexis/peak/refs/heads/main/music"))()
end)

if game.PlaceId == 86496104885280 then
    createButton("Teleport to Lobby Test", function()
        teleportTo(95932206229482)
    end)
end

if game.PlaceId == 119361335046198 then
    createButton("Collect Speed Orbs", function()
        collectAllOrbs()
    end)
    createButton("Collect Rings", function()
        collectAllRings()
    end)
    createButton("TP Back to Lobby Test", function()
        teleportTo(95932206229482)
    end)
end
